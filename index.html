<!DOCTYPE html>
<meta charset="utf-8">
<title>Extreme Weather Phenomena in Greece from 2010-2018</title>

<style>

body {
  font: 15px sans-serif;
   margin: auto;
    width: 50%;
    padding: 10px;
}
  

.axis path,
.axis line {
  fill: none;
  stroke: #000;
  shape-rendering: crispEdges;
}

.x.axis path {
  display: none;
}

.line {
  fill: none;
  stroke: steelblue;
  stroke-width: 1.5px;
}

.overlay {
  fill: none;
  pointer-events: all;
}

.focus circle {
  fill: none;
  stroke: steelblue;
}
</style>
<body>
  <div id="header">
<h1>Extreme Weather Phemomena in Greece (2010-2018)</h1>
<h2>An analysis of the Observed phenomena - Charts</h2>
</div>
<div id="wrapper">
<hr>
<h2>Introduction</h2>
<p>This study presents the Hellenic Extreme Weather Database of high-impact weather events that occurred in Greece in the period 2010-2018 (9 years).
The selected events are related to the occurrence of meteorological (tornadic events, lightinigs, hailstorms) and hydrological (flash floods) events with adverse socio-economic consequences.
The database includes, among others, the geographical location of the recorded events, the date and a brief description of the induced impacts.
Below we will analyze the selected phenomena and see a few time animations. </p>
  <hr>
		<h3>Flash Floods</h3>
		<p>Flash floods are called floods where they break out suddenly and are the result of heavy rainfall, extreme storms, siphons or even glacier melting water.
			Floods result in the loss of human lives, destruction of buildings and structures, road network, sewerage systems and electricity transmission networks. The destruction of these infrastructures can lead to disruption of drinking water supply, transport and communication difficulties, the occurrence of diseases related to drinking water quality and difficulties in healthcare.</p>
		<p>Flash floods mainly occur during the autumn period, and they occur mainly along coastal regions and in close proximity of large city centres.A special factor that is related to the spatial allocation of flash floods is urban sprawl. 
			High density residential development increases the number of individuals and properties at risk.</p>
	
<button id="start" style="position: absolute; margin-left: 6px; margin-top: 6px;">Start Time Animation</button>
<button id="reset" style="position: absolute; margin-left: 150px; margin-top: 6px">Reset</button>
<p style="position: absolute; margin-left: 212px; margin-top: 12px; text-size: 12px">Flash Floods incidents, January 2010-August 2018 (with Animation)</p>
<script src="d3.v4.min.js" charset="utf-8"></script>
<script>

var margin = {top: 60, right: 20, bottom: 30, left: 50},
    width = 700 - margin.left - margin.right,
    height = 365 - margin.top - margin.bottom;

// Adjust parsing of data to properly show tooltip
var parseDate = d3.timeParse("%Y"),
    bisectDate = d3.bisector(function(d) { return d.year; }).left,
    formatValue = d3.format(".2"),
    formatCurrency = function(d) { return formatValue(d) ; };

var x = d3.scaleTime()
  .range([0, width]);

var y = d3.scaleLinear()
    .range([height, 0]);

var xAxis = d3.axisBottom()
    .scale(x);

var yAxis = d3.axisLeft()
    .scale(y);

var line = d3.line()
    .x(function(d) { return x(d.year); })
    .y(function(d) { return y(d.floods); });

var svg = d3.select("body").append("svg")
    .attr("width", width + margin.left + margin.right)
    .attr("height", height + margin.top + margin.bottom)
  .append("g")
    .attr("transform", "translate(" + margin.left + "," + margin.top + ")");

d3.csv("SS.csv", function(error, data) {
  if (error) throw error;
  console.log(data);

  data.forEach(function(d) {
    d.year = parseDate(d.year);
    d.floods = +d.floods;
  });

  x.domain(d3.extent(data, function(d) { return d.year; }));
  y.domain(d3.extent(data, function(d) { return d.floods; }));

  svg.append("g")
      .attr("class", "x axis")
      .attr("transform", "translate(0," + height + ")")
      .call(xAxis);

  svg.append("g")
      .attr("class", "y axis")
      .call(yAxis)
    .append("text")
      .attr("transform", "rotate(-90)")
      .attr("y", 6)
      .attr("dy", ".71em")
      .style("text-anchor", "end")
      .text("");

  // Start Animation on Click
  d3.select("#start").on("click", function() {
    var path = svg.append("path")
        .datum(data)
        .attr("class", "line")
        .attr("d", line);

    // Variable to Hold Total Length
    var totalLength = path.node().getTotalLength();

    // Set Properties of Dash Array and Dash Offset and initiate Transition
    path
      .attr("stroke-dasharray", totalLength + " " + totalLength)
      .attr("stroke-dashoffset", totalLength)
     .transition() // Call Transition Method
      .duration(4000) // Set Duration timing (ms)
      .ease(d3.easeLinear) // Set Easing option
      .attr("stroke-dashoffset", 0); // Set final value of dash-offset for transition

    // Create SVG for Tooltip and Circle on Mouseover
    var focus = svg.append("g")
        .attr("class", "focus")
        .style("display", "none");

    // Append a circle to show on Mouseover
    focus.append("circle")
        .attr("r", 4.5);

    // Append text to show on Mouseover
    focus.append("text")
        .attr("x", 9)
        .attr("dy", ".35em");

    // Append overlay rectangle as container for Circle and Tooltips
    // that allows user to hover anywhere on graphic
    svg.append("rect")
        .attr("class", "overlay")
        .attr("width", width)
        .attr("height", height)
        .on("mouseover", function() { focus.style("display", null); })
        .on("mouseout", function() { focus.style("display", "none"); })
        .on("mousemove", mousemove);

    // Mousemove function that sets location and changes properties of Focus SVG
    function mousemove() {
      var x0 = x.invert(d3.mouse(this)[0]),
          i = bisectDate(data, x0, 1),
          d0 = data[i - 1],
          d1 = data[i],
          d = x0 - d0.year > d1.year - x0 ? d1 : d0;
      focus.attr("transform", "translate(" + x(d.year) + "," + y(d.floods) + ")");
      focus.select("text").text(formatCurrency(d.floods));
    }
  });

  // Reset Animation
  d3.select("#reset").on("click", function() {
    d3.select(".line").remove();
  });
});

</script>
